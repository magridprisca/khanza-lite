<ul class="nav nav-tabs">
    <li><a href="{?=url([ADMIN,'manajemen','dashboard'])?}">Dashboard</a></li>
    <li><a href="{?=url([ADMIN,'manajemen','pendaftaran'])?}">Pendaftaran</a></li>
    <li><a href="{?=url([ADMIN,'manajemen','caradaftar'])?}">Cara Daftar</a></li>
    <li class="active"><a href="{?=url([ADMIN,'manajemen','rawatjalan'])?}">Rawat Jalan</a></li>
    <li><a href="{?=url([ADMIN,'manajemen','rawatinap'])?}">Rawat Inap</a></li>
    <li><a href="{?=url([ADMIN,'manajemen','dokter'])?}">Dokter</a></li>
    <li><a href="{?=url([ADMIN,'manajemen','laboratorium'])?}">Laboratorium</a></li>
    <li><a href="{?=url([ADMIN,'manajemen','radiologi'])?}">Radiologi</a></li>
    <li><a href="{?=url([ADMIN,'manajemen','apotek'])?}">Apotek</a></li>
    <li><a href="{?=url([ADMIN,'manajemen','farmasi'])?}">Farmasi</a></li>
    <li><a href="{?=url([ADMIN,'manajemen','kasir'])?}">Kasir</a></li>
    <li><a href="{?=url([ADMIN,'manajemen','presensi'])?}">Presensi</a></li>
</ul>
<br>
<div class="row">
    <div class="col-md-3 col-sm-6 col-xs-12">
        <div class="panel panel-default">
              <div class="panel-body bg-danger">
                    <span class="fa-2x fa-stack fa-lg pull-left">
                        <i class="fa fa-calendar-plus-o fa-stack-1x"></i>
                    </span>
                    <div class="stat-title text-grey">Total Kunjungan</div>
                    <div class="stat-bold">
                        {?= $stats.getVisities ?}
                        <span class="stat-up-down">
                            <i class="fa fa-arrow-circle-{if: $stats.percentTotal >= 0}up{else}down{/if}"></i>
                            ({?= $stats.percentTotal ?}%)
                        </span>
                    </div>
              </div>
        </div>
    </div>
    <div class="col-md-3 col-sm-6 col-xs-12">
        <div class="panel panel-default">
              <div class="panel-body bg-info">
                    <span class="fa-2x fa-stack fa-lg pull-left">
                        <i class="fa fa-calendar fa-stack-1x"></i>
                    </span>
                    <div class="stat-title text-grey">Pasien Dirujuk Hari Ini</div>
                    <div class="stat-bold">
                        {?= $stats.getRujuk ?}
                        <span class="stat-up-down">
                            <i class="fa fa-arrow-circle-{if: $stats.percentDays >= 0}up{else}down{/if}"></i>
                            ({?= $stats.percentDays ?}%)
                        </span>
                    </div>
              </div>
        </div>
    </div>
    <div class="col-md-3 col-sm-6 col-xs-12">
        <div class="panel panel-default">
              <div class="panel-body bg-warning">
                    <span class="fa-2x fa-stack fa-lg pull-left">
                        <i class="fa fa-users fa-stack-1x"></i>
                    </span>
                    <div class="stat-title text-grey">Pasien Dirawat Hari Ini</div>
                    <div class="stat-bold">
                        {?= $stats.getRawat ?}
                        <span class="stat-up-down">
                            <i class="fa fa-arrow-circle-{if: $stats.percentDaysBatal >= 0}up{else}down{/if}"></i>
                            ({?= $stats.percentDaysBatal ?}%)
                        </span>
                    </div>
              </div>
        </div>
    </div>
    <div class="col-md-3 col-sm-6 col-xs-12">
        <div class="panel panel-default">
              <div class="panel-body bg-success">
                    <span class="fa-2x fa-stack fa-lg pull-left">
                        <i class="fa fa-wheelchair fa-stack-1x"></i>
                    </span>
                    <div class="stat-title text-grey">Pasien Yang Dilayani Hari Ini</div>
                    <div class="stat-bold">
                        {?= $stats.getSudah ?}
                        <span class="stat-up-down">
                            <i class="fa fa-arrow-circle-{if: $stats.percentDaysBaru >= 0}up{else}down{/if}"></i>
                            ({?= $stats.percentDaysBaru ?}%)
                        </span>
                    </div>
              </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-lg-12 col-md-12">
        <div class="panel panel-default">
            <div class="panel-heading">
                <h3 class="panel-title">10 Diagnosa Terbanyak Hari Ini</h3>
            </div>
            <div class="panel-body">
                <canvas id="line-chartcanvas" height="350"></canvas>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-lg-12 col-md-12">
        <div class="panel panel-default">
            <div class="panel-heading">
                <h3 class="panel-title">Laporan Rawat Jalan Harian</h3>
            </div>
            <div class="panel-body">
                <div class="row">
                    <form class="" action="{?=url([ADMIN,'manajemen','rawatjalan'])?}" method="POST">
                        <div class="col-lg-3 col-md-3">
                            <input type="date"  class="form-control" name="rajal_tgl_awal" value="{?= $tglawal ?}"required>
                        </div>
                        <div class="col-lg-3 col-md-3">
                            <input type="date"  class="form-control" name="rajal_tgl_akhir" value="{?= $tglakhir ?}"required>
                        </div>
                        <div class="col-lg-3 col-md-3">
                            <select class="form-control" name="poli_periode" required>
                            {loop: $poli}
                                { $cek = ($poli_periode==$value.kd_poli)}
                                <option value="{$value.kd_poli}" {if: $poli_periode==$value.kd_poli}selected{/if} >{$value.nm_poli}</option>
                                <!-- <option value="{$value.kd_poli}" >{$value.nm_poli}</option> -->
                            {/loop}
                            </select>
                        </div>
                        <div class="col-lg-2 col-md-3">
                            <input type="submit" name="" class="btn btn-primary btn-block" value="Cari">
                        </div>
                        
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-lg-12 col-md-12">
        <div class="panel panel-default">
            <div class="panel-heading">
                <h3 class="panel-title">Poli {?=  $stats.poliChartPeriode.labels2[0] ?}</h3>
            </div>
            <div class="panel-body">
                <canvas id="line-chart-dateperiode" height="350"></canvas>
            </div>
        </div>
    </div>
</div>


<div class="row">
    <div class="col-lg-12 col-md-12">
        <div class="panel panel-default">
            <div class="panel-heading">
                <h3 class="panel-title">Laporan Rawat Jalan Bulanan</h3>
            </div>
            <div class="panel-body">
                <div class="row">
                    <form class="" action="{?=url([ADMIN,'manajemen','rawatjalan'])?}" method="POST">
                        <div class="col-lg-3 col-md-3">
                            <input type="month"  class="form-control" name="rajal_bln_awal" value="{?= $bulanawal ?}"required>
                        </div>
                        <div class="col-lg-3 col-md-3">
                            <input type="month"  class="form-control" name="rajal_bln_akhir" value="{?= $bulanakhir ?}"required>
                        </div>
                        <div class="col-lg-3 col-md-3">
                            <select class="form-control" name="poli_bulan" required>
                            {loop: $poli}
                                <option value="{$value.kd_poli}" {if: $poli_bulan==$value.kd_poli}selected{/if} >{$value.nm_poli}</option>
                                <!-- <option value="{$value.kd_poli}" >{$value.nm_poli}</option> -->
                            {/loop}
                            </select>
                        </div>
                        <div class="col-lg-2 col-md-3">
                            <input type="submit" name="" class="btn btn-primary btn-block" value="Cari">
                        </div>
                        
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-lg-12 col-md-12">
        <div class="panel panel-default">
            <div class="panel-heading">
                <h3 class="panel-title">Poli {?=  $stats.poliChartBulan.labels2[0] ?}</h3>
            </div>
            <div class="panel-body">
                <canvas id="line-chart-datebulan" height="350"></canvas>
            </div>
        </div>
    </div>
</div>


<div class="row">
    <div class="col-lg-12 col-md-12">
        <div class="panel panel-default">
            <div class="panel-heading">
                <h3 class="panel-title">Laporan Rawat Jalan Tahunan</h3>
            </div>
            <div class="panel-body">
                <div class="row">
                    <form class="" action="{?=url([ADMIN,'manajemen','rawatjalan'])?}" method="POST">
                        <div class="col-lg-3 col-md-3">
                            <input type="number" class="form-control" name="rajal_thn_awal" value="{?= $tahunawal ?}"required>
                        </div>
                        <div class="col-lg-3 col-md-3">
                            <input type="number" class="form-control" name="rajal_thn_akhir" value="{?= $tahunakhir ?}"required>
                            <!-- <select class="form-control" name="rajal_thn_akhir">
                                {loop: date()}
                                <option value="{?= $tahunakhir ?}"></option>
                                {/loop}
                            </select> -->
                        </div>
                        <div class="col-lg-3 col-md-3">
                            <select class="form-control" name="poli_tahun" required>
                            {loop: $poli}
                                <option value="{$value.kd_poli}" {if: $poli_tahun==$value.kd_poli}selected{/if} >{$value.nm_poli}</option>
                                <!-- <option value="{$value.kd_poli}" >{$value.nm_poli}</option> -->
                            {/loop}
                            </select>
                        </div>
                        <div class="col-lg-2 col-md-3">
                            <input type="submit" name="" class="btn btn-primary btn-block" value="Cari">
                        </div>
                        
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-lg-12 col-md-12">
        <div class="panel panel-default">
            <div class="panel-heading">
                <h3 class="panel-title">Poli {?=  $stats.poliChartTahun.labels2[0] ?}</h3>
            </div>
            <div class="panel-body">
                <canvas id="line-chart-datetahun" height="350"></canvas>
            </div>
        </div>
    </div>
</div>

<script type="text/javascript">
    $(function () {

        //line chart diagnosa
        var ctx = document.getElementById("line-chartcanvas");
        var myChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: ["{?= implode('","', $stats.poliChartBaru.labels) ?}"],
                datasets: [{
                        label: "Pasien",
                        borderColor: "#34316E",
                        borderWidth: "2",
                        backgroundColor: "rgba(30, 30, 45, 0.2)",
                        pointHighlightStroke: "#1e1e2d",
                        pointRadius: 0,
                        data: ["{?= implode('","', $stats.poliChartBaru.visits) ?}"],
                    }
                ]
            },
            options: {
                legend: {
                    display: false
                },
                responsive: true,
                tooltips: {
                    mode: 'index',
                    intersect: false
                },
                hover: {
                    mode: 'nearest',
                    intersect: true
                },
                maintainAspectRatio: false
            }
        });

        // line chart laporan per periode
        var ctx2 = document.getElementById("line-chart-dateperiode");
        var myChart = new Chart(ctx2, {
            type: 'bar',
            data: {
                labels: ["{?= implode('","', $stats.poliChartPeriode.labels) ?}"],
                datasets: [{
                        label: "Pasien",
                        // label: ["{?= implode('","', $stats.poliChartPeriode.labels) ?}"],
                        borderColor: "#34316E",
                        borderWidth: "2",
                        backgroundColor: "rgba(30, 30, 45, 0.2)",
                        pointHighlightStroke: "#1e1e2d",
                        pointRadius: 0,
                        data: ["{?= implode('","', $stats.poliChartPeriode.visits) ?}"],
                    }
                ]
            },
            options: {
                scales: {
                    yAxes: [{
                        ticks: {
                            beginAtZero: true
                        }
                    }]
                },
                legend: {
                    display: false
                },
                tooltips: {
                    mode: 'index',
                    intersect: false
                },
                hover: {
                    mode: 'nearest',
                    intersect: true
                },
                responsive: true,
                maintainAspectRatio: false
            }
        });

        
        // line chart laporan per bulan
        var ctx2 = document.getElementById("line-chart-datebulan");
        var myChart = new Chart(ctx2, {
            type: 'bar',
            data: {
                labels: ["{?= implode('","', $stats.poliChartBulan.labels) ?}"],
                datasets: [{
                        label: "Pasien",
                        // label: ["{?= implode('","', $stats.poliChartBulan.labels) ?}"],
                        borderColor: "#34316E",
                        borderWidth: "2",
                        backgroundColor: "rgba(30, 30, 45, 0.2)",
                        pointHighlightStroke: "#1e1e2d",
                        pointRadius: 0,
                        data: ["{?= implode('","', $stats.poliChartBulan.visits) ?}"],
                    }
                ]
            },
            // onAnimationComplete: function () {
            //     var ctx = this.chart.ctx;
            //     ctx.font = this.scale.font;
            //     ctx.fillStyle = this.scale.textColor
            //     ctx.textAlign = "center";
            //     ctx.textBaseline = "bottom";

            //     this.datasets.forEach(function (dataset) {
            //         dataset.bars.forEach(function (bar) {
            //             ctx.fillText(bar.value, bar.x, bar.y - 5);
            //         });
            //     })
            // },
            options: {
                scales: {
                    yAxes: [{
                        ticks: {
                            beginAtZero: true
                        }
                    }]
                },
                legend: {
                    display: false,
                },
                tooltips: {
                    mode: 'index',
                    intersect: false
                },
                hover: {
                    mode: 'nearest',
                    intersect: true
                },
                responsive: true,
                maintainAspectRatio: false
            }
        });

         // line chart laporan per tahun
         var ctx2 = document.getElementById("line-chart-datetahun");
        var myChart = new Chart(ctx2, {
            type: 'bar',
            data: {
                labels: ["{?= implode('","', $stats.poliChartTahun.labels) ?}"],
                datasets: [{
                        label: "Pasien",
                        borderColor: "#34316E",
                        borderWidth: "2",
                        backgroundColor: "rgba(30, 30, 45, 0.2)",
                        pointHighlightStroke: "#1e1e2d",
                        pointRadius: 0,
                        data: ["{?= implode('","', $stats.poliChartTahun.visits) ?}"],
                    }
                ]
            },
            options: {
                scales: {
                    yAxes: [{
                        ticks: {
                            beginAtZero: true
                        }
                    }]
                },
                legend: {
                    display: false,
                },
                tooltips: {
                    mode: 'index',
                    intersect: false
                },
                hover: {
                    mode: 'nearest',
                    intersect: true
                },
                responsive: true,
                maintainAspectRatio: false
            }
        });


    });

</script>
